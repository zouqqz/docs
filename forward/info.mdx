---
title: "如何使用"
---

<Note> 用于将三三的数据通过 MQTT 转发到第三方系统 </Note>

## 内部转发

内部转发指第三方系统连接三三平台的 MQTT 服务器订阅数据，开启步骤如下

<Steps>
  <Step title="开启订阅">
  开发者登录开发者账号，进入`系统` -> `MQTT 订阅`，开启订阅

  ![image-20250826094220848](/img/image-20250826094220848.png)

  </Step>
  <Step title="MQTT 登录">
  
  设置 MQTT 账号密码，使用 MQTT 客户端登录三三的 MQTT 服务器，端口是 9010。

  </Step>

  <Step title="订阅主题">
  
  批量订阅所有租户的主题: /sansan/data/forward/\{开发者账号\}/# 
  
  或按租户订阅主题: /sansan/data/forward/\{开发者登录账号\/\{租户账号\}

  </Step>
</Steps>

<Note> 开发者开启订阅，会转发开发者创建的所有租户的业务数据，内部转发只允许开发者账户使用 </Note>


## 外部转发

外部转发指三三平台推送数据到第三方系统的 MQTT 服务器，配置步骤如下

<Steps>
  <Step title="配置服务器">
    租户登录租户账号，进入`设备` -> `数据转发`  -> `转发服务`

    配置 MQTT 服务器 IP、端口、用户名、密码，测试服务器是否可用
  </Step>

  <Step title="配置转发规则">
    进入`设备` -> `数据转发`  -> `转发规则`
    
    配置转发规则，支持按产品转发、按设备转发、按账号转发

    配置转发变量名映射（可选）
  </Step>

  <Step title="订阅主题">
    使用 MQTT 客户端登录 MQTT 服务器，订阅主题: /sansan/data/forward
  </Step>

</Steps>


<Note> 外部转发需要将第三方系统的 MQTT Broker 信息配置到三三，外部转发只允许租户账户使用</Note>